The only other namespace change. Note that pach 01-netdev.patch
also has some other namespace changes there, look at that file
for the other changes. It'd be nice to figure out a way to
bring thise here cleanly and seprately but they touch the same
files...

--- a/net/wireless/nl80211.c	2009-07-27 16:22:30.301045695 -0700
+++ b/net/wireless/nl80211.c	2009-07-27 18:17:28.445046102 -0700
@@ -29,7 +29,9 @@
 	.hdrsize = 0,		/* no private header */
 	.version = 1,		/* no particular meaning now */
 	.maxattr = NL80211_ATTR_MAX,
+#if (LINUX_VERSION_CODE >= KERNEL_VERSION(2,6,32))
 	.netnsok = true,
+#endif
 };
 
 /* internal helper: get rdev and dev */
--- a/net/wireless/nl80211.c	2010-01-05 22:46:25.000000000 -0800
+++ b/net/wireless/nl80211.c	2010-01-05 22:48:33.000000000 -0800
@@ -14,7 +14,9 @@
 #include <linux/rtnetlink.h>
 #include <linux/netlink.h>
 #include <linux/etherdevice.h>
+#if (LINUX_VERSION_CODE >= KERNEL_VERSION(2,6,24))
 #include <net/net_namespace.h>
+#endif
 #include <net/genetlink.h>
 #include <net/cfg80211.h>
 #include <net/sock.h>
@@ -4048,7 +4050,9 @@
 
 	err = cfg80211_switch_netns(rdev, net);
  out_put_net:
+#if (LINUX_VERSION_CODE >= KERNEL_VERSION(2,6,24))
 	put_net(net);
+#endif
  out:
 	cfg80211_unlock_rdev(rdev);
  out_rtnl:
--- a/net/wireless/core.c	2010-01-05 23:07:11.000000000 -0800
+++ b/net/wireless/core.c	2010-01-05 23:07:12.000000000 -0800
@@ -224,6 +224,7 @@ int cfg80211_dev_rename(struct cfg80211_
 	return 0;
 }
 
+#if (LINUX_VERSION_CODE >= KERNEL_VERSION(2,6,24))
 int cfg80211_switch_netns(struct cfg80211_registered_device *rdev,
 			  struct net *net)
 {
@@ -259,6 +260,7 @@ int cfg80211_switch_netns(struct cfg8021
 
 	return err;
 }
+#endif
 
 static void cfg80211_rfkill_poll(struct rfkill *rfkill, void *data)
 {
@@ -365,7 +367,9 @@ struct wiphy *wiphy_new(const struct cfg
 
 	rdev->wiphy.ps_default = CONFIG_CFG80211_DEFAULT_PS_VALUE;
 
+#if (LINUX_VERSION_CODE >= KERNEL_VERSION(2,6,24))
 	wiphy_net_set(&rdev->wiphy, &init_net);
+#endif
 
 	rdev->rfkill_ops.set_block = cfg80211_rfkill_set_block;
 	rdev->rfkill = rfkill_alloc(dev_name(&rdev->wiphy.dev),
@@ -655,8 +659,10 @@ static int cfg80211_netdev_notifier_call
 		mutex_lock(&rdev->devlist_mtx);
 		list_add(&wdev->list, &rdev->netdev_list);
 		rdev->devlist_generation++;
+#if (LINUX_VERSION_CODE >= KERNEL_VERSION(2,6,24))
 		/* can only change netns with wiphy */
 		dev->features |= NETIF_F_NETNS_LOCAL;
+#endif
 
 		if (sysfs_create_link(&dev->dev.kobj, &rdev->wiphy.dev.kobj,
 				      "phy80211")) {
@@ -781,6 +787,7 @@ static struct notifier_block cfg80211_ne
 	.notifier_call = cfg80211_netdev_notifier_call,
 };
 
+#if (LINUX_VERSION_CODE >= KERNEL_VERSION(2,6,24))
 static void __net_exit cfg80211_pernet_exit(struct net *net)
 {
 	struct cfg80211_registered_device *rdev;
@@ -798,14 +805,17 @@ static void __net_exit cfg80211_pernet_e
 static struct pernet_operations cfg80211_pernet_ops = {
 	.exit = cfg80211_pernet_exit,
 };
+#endif
 
 static int __init cfg80211_init(void)
 {
 	int err;
 
+#if (LINUX_VERSION_CODE >= KERNEL_VERSION(2,6,24))
 	err = register_pernet_device(&cfg80211_pernet_ops);
 	if (err)
 		goto out_fail_pernet;
+#endif
 
 	err = wiphy_sysfs_init();
 	if (err)
@@ -834,8 +844,10 @@ out_fail_nl80211:
 out_fail_notifier:
 	wiphy_sysfs_exit();
 out_fail_sysfs:
+#if (LINUX_VERSION_CODE >= KERNEL_VERSION(2,6,24))
 	unregister_pernet_device(&cfg80211_pernet_ops);
 out_fail_pernet:
+#endif
 	return err;
 }
 subsys_initcall(cfg80211_init);
@@ -847,6 +859,8 @@ static void cfg80211_exit(void)
 	unregister_netdevice_notifier(&cfg80211_netdev_notifier);
 	wiphy_sysfs_exit();
 	regulatory_exit();
+#if (LINUX_VERSION_CODE >= KERNEL_VERSION(2,6,24))
 	unregister_pernet_device(&cfg80211_pernet_ops);
+#endif
 }
 module_exit(cfg80211_exit);
--- a/net/wireless/wext.c	2010-01-05 23:19:11.000000000 -0800
+++ b/net/wireless/wext.c	2010-01-05 23:20:53.000000000 -0800
@@ -684,7 +684,11 @@
 		return SEQ_START_TOKEN;
 
 	off = 1;
+#if (LINUX_VERSION_CODE >= KERNEL_VERSION(2,6,24))
 	for_each_netdev(net, dev)
+#else
+	for_each_netdev(net)
+#endif
 		if (off++ == *pos)
 			return dev;
 	return NULL;
@@ -1339,7 +1339,11 @@
 {
 	struct sk_buff *skb;
 	while ((skb = skb_dequeue(&wireless_nlevent_queue)))
+#if (LINUX_VERSION_CODE >= KERNEL_VERSION(2,6,24))
 		rtnl_notify(skb, &init_net, 0, RTNLGRP_LINK, NULL, GFP_ATOMIC);
+#else
+		rtnl_notify(skb, 0, RTNLGRP_LINK, NULL, GFP_ATOMIC);
+#endif
 }
 
 static DECLARE_TASKLET(wireless_nlevent_tasklet, wireless_nlevent_process, 0);
